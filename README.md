# Predicting Heart Attacks Using Machine Learning

## Overview
This project applies machine learning techniques to predict the risk of heart attacks based on patient data.  
It includes modules for data cleaning, feature engineering, model training, evaluation, and prediction.  
Multiple models are supported, and results can be compared across training, validation, and test sets.

## Project Structure
- **config.py**: Defines paths, features, and training setup.  
- **data_cleaning.py**: Cleans raw patient data and prepares it for modeling.  
- **feature_engineering.py**: Adds engineered medical risk features and builds preprocessing pipelines.  
- **models.py**: Defines model pipelines (Logistic Regression, KNN, Decision Tree, Random Forest, XGBoost).  
- **train.py**: Trains a selected model, evaluates performance, and saves the trained pipeline.  
- **evaluation.py**: Generates ROC, Precision‑Recall, and confusion matrix plots.  
- **predict.py**: Loads a trained model and generates predictions for new patient data.  
- **compare_models.py**: Trains all models in the registry and compares their metrics.  
- **main.py**: Entry point script that controls workflow (clean, train, predict).

## Requirements
- Python 3.9+  
- Required libraries: `pandas`, `scikit-learn`, `matplotlib`, `joblib`, `xgboost`

Install dependencies with:
pip install -r requirements.txt

## Data Preparation
1. Place the raw dataset (`HeartAttackData.csv`) inside the `data/` folder.  
2. Run the cleaning step to generate a cleaned dataset:
python main.py --step clean

This saves the cleaned dataset as `CleanedHeartAttackData.csv` in the `data/` folder.

## Training a Model
To train a specific model:
python main.py --step train --model log_reg

Available models:
- `log_reg` (Logistic Regression)  
- `knn` (K-Nearest Neighbors)  
- `dt` (Decision Tree)  
- `rf` (Random Forest)  
- `xgb` (XGBoost)  

The trained model is saved in the `artifacts/` folder.

## Comparing Models
To train and evaluate all models at once:
python compare_models.py

This prints metrics for each model across train, validation, and test sets.

## Making Predictions
To generate predictions for new patient data from a CSV file:
python main.py --step predict --model rf --input data/PredictHeartAttackData.csv

The script prints predicted risk (High Risk / Low Risk) and probabilities if available.

## Evaluation Plots
Evaluation plots (ROC curve, Precision‑Recall curve, confusion matrix) can be generated by uncommenting the line in `train.py`:
```python
# plot_evaluation(pipeline, X_test, y_test, model_name)

This displays plots after training a model.
